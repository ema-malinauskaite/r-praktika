#library("matlib")
library("pracma")
#library("Smisc")
library("readr")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readRDS("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
library("tidyverse")
library("data.table")
library("compareDF")
library("tidyr")
#library("matlib")
library("pracma")
#library("Smisc")
library("readr")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
pro_344_sm_suppinfo <- readRDS("~/Desktop/praktika/r-praktika/data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("~/Desktop/praktika/r-praktika/data/pro_344_sm_suppinfo.rds")
nuline_lentele_platusis <- readr::read_rds("./data/nuline_lentele_platusis.rds")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("~Desktop/praktika/r-praktika/data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("~/Desktop/praktika/r-praktika/data/pro_344_sm_suppinfo.rds")
nuline_lentele_platusis <- readr::read_rds("./data/nuline_lentele_platusis.rds")
lizocimai_pagr <- readr::read_rds("~/Desktop/praktika/r-praktika/data/pro_344_sm_suppinfo.rds")
nuline_lentele_platusis <- readr::read_rds("~/Desktop/praktika/r-praktika/data/nuline_lentele_platusis.rds")
wtx_1L63_platusis <- readr::read_rds("~/Desktop/praktika/r-praktika/data/wtx_1L63_platusis.rds")
wt_2LZM_platusis <- readr::read_rds("~/Desktop/praktika/r-praktika/data/wt_2LZM_platusis.rds")
pdb_tm_229 <- lizocimai_pagr %>%
select(pdb, deltaTm, WT) %>%
drop_na(pdb, deltaTm) %>%
filter(pdb != "2LZM" & pdb != "1L63") %>%
head(229)
library("tidyverse")
library("data.table")
library("compareDF")
library("tidyr")
#library("matlib")
library("pracma")
#library("Smisc")
library("readr")
pdb_tm_229 <- lizocimai_pagr %>%
select(pdb, deltaTm, WT) %>%
drop_na(pdb, deltaTm) %>%
filter(pdb != "2LZM" & pdb != "1L63") %>%
head(229)
pdb_tm_229
fun_kontaktu_sumai <- function(liz_kont, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- liz_kont %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont_matrica <- as.matrix(data.frame(ar_1 = liz_kont$V6, ar_2 = liz_kont$V13))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "_")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".") %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
kont_sumos_plat <- spread(kont_sumos, kontakto_tipas, kontakto_suma)
sujungta <- full_join(nul_lentele_plat, kont_sumos_plat) %>%
gather() %>%
group_by(key) %>%
summarise(kontakto_suma = sum(value)) %>%
mutate_all(~replace(., is.na(.), 0)) %>%
spread(., key, kontakto_suma)
return(sujungta)
}
library("tidyverse")
library("data.table")
library("compareDF")
library("tidyr")
#library("matlib")
library("pracma")
#library("Smisc")
library("readr")
lizocimai_pagr <- readr::read_rds("~/Desktop/praktika/r-praktika/data/pro_344_sm_suppinfo.rds")
nuline_lentele_platusis <- readr::read_rds("~/Desktop/praktika/r-praktika/data/nuline_lentele_platusis.rds")
wtx_1L63_platusis <- readr::read_rds("~/Desktop/praktika/r-praktika/data/wtx_1L63_platusis.rds")
wt_2LZM_platusis <- readr::read_rds("~/Desktop/praktika/r-praktika/data/wt_2LZM_platusis.rds")
pdb_tm_229 <- lizocimai_pagr %>%
select(pdb, deltaTm, WT) %>%
drop_na(pdb, deltaTm) %>%
filter(pdb != "2LZM" & pdb != "1L63") %>%
head(229)
pdb_tm_229
matricu_lenteles_229 <- fun_kont_sum_ir_temp_skirtumams(pdb_tm_229, wtx_platusis = wtx_1L63_platusis, wt_platusis = wt_2LZM_platusis, nuline_lentele_platusis)
lizocimai_pagr <- readr::read_rds("../data/pro_344_sm_suppinfo.rds")
nuline_lentele_platusis <- readr::read_rds("~/Desktop/praktika/r-praktika/data/nuline_lentele_platusis.rds")
wtx_1L63_platusis <- readr::read_rds("~/Desktop/praktika/r-praktika/data/wtx_1L63_platusis.rds")
wt_2LZM_platusis <- readr::read_rds("~/Desktop/praktika/r-praktika/data/wt_2LZM_platusis.rds")
lizocimai_pagr <- readr::read_rds("../data/pro_344_sm_suppinfo.rds")
nuline_lentele_platusis <- readr::read_rds("../data/nuline_lentele_platusis.rds")
wtx_1L63_platusis <- readr::read_rds("../data/wtx_1L63_platusis.rds")
wt_2LZM_platusis <- readr::read_rds("../data/wt_2LZM_platusis.rds")
#input:
# pdb_termo_lent - lentele, kurioje vienas stulpelis pasirinktas termodinaminis parametras, kitas stulpelis pdb failo pavadinimas
# WT_platusis - sutvarkyta pasirinkto wt placiojo formato, su kuriuo bus lyginami kiti baltymai lentele su kontaktu plotu sumomis
# WT_termo - pasirinkto termodinaminio parametro reiksme pasirinktam WT tipui
# nul_lent_plat - nuline lentele skirta fun_kontaktu_sumai
fun_kont_sum_ir_temp_skirtumams <- function(pdb_termo_lent, wt_platusis, wtx_platusis, nul_lent_plat) {
visu_baltymu_kont_sumu_skirtumai <- data.frame()
termo_skirtumai <- data.frame() #desine tiesiniu lygciu sistemos puse matricose
#----
for (i in pdb_termo_lent$pdb) {
lizocimo_kontaktai <- data.table::fread(paste("../lizocimai/",i,".contacts.interresidue.table", sep = ""))
kontaktu_sumos <- fun_kontaktu_sumai(lizocimo_kontaktai, nul_lent_plat)
viena_eilute <- pdb_termo_lent %>%
filter(pdb == i)
if (viena_eilute$WT == "wt") {
wt_ir_lizocimas <- rbind(wt_platusis, kontaktu_sumos) %>%
transpose(keep.names = "kontakto_tipas") %>%
mutate(kont_sumu_skirtumas = V1 - V2) %>%
select(kontakto_tipas, kont_sumu_skirtumas) %>%
transpose(make.names = "kontakto_tipas")
} else {
wt_ir_lizocimas <- rbind(wtx_platusis, kontaktu_sumos) %>%
transpose(keep.names = "kontakto_tipas") %>%
mutate(kont_sumu_skirtumas = V1 - V2) %>%
select(kontakto_tipas, kont_sumu_skirtumas) %>%
transpose(make.names = "kontakto_tipas")
}
visu_baltymu_kont_sumu_skirtumai <- rbind(visu_baltymu_kont_sumu_skirtumai, wt_ir_lizocimas)
lizocimo_kontaktai = NULL
}
termo_skirtumai <- pdb_termo_lent %>%
select(-WT, -pdb)# %>%
#transpose(make.names = "pdb")
return(list(visu_baltymu_kont_sumu_skirtumai = as.matrix(visu_baltymu_kont_sumu_skirtumai),termo_skirtumai = as.matrix(termo_skirtumai)))
}
fun_kontaktu_sumai <- function(liz_kont, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- liz_kont %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont_matrica <- as.matrix(data.frame(ar_1 = liz_kont$V6, ar_2 = liz_kont$V13))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "_")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".") %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
kont_sumos_plat <- spread(kont_sumos, kontakto_tipas, kontakto_suma)
sujungta <- full_join(nul_lentele_plat, kont_sumos_plat) %>%
gather() %>%
group_by(key) %>%
summarise(kontakto_suma = sum(value)) %>%
mutate_all(~replace(., is.na(.), 0)) %>%
spread(., key, kontakto_suma)
return(sujungta)
}
#input:
# pdb_termo_lent - lentele, kurioje vienas stulpelis pasirinktas termodinaminis parametras, kitas stulpelis pdb failo pavadinimas
# WT_platusis - sutvarkyta pasirinkto wt placiojo formato, su kuriuo bus lyginami kiti baltymai lentele su kontaktu plotu sumomis
# WT_termo - pasirinkto termodinaminio parametro reiksme pasirinktam WT tipui
# nul_lent_plat - nuline lentele skirta fun_kontaktu_sumai
fun_kont_sum_ir_temp_skirtumams <- function(pdb_termo_lent, wt_platusis, wtx_platusis, nul_lent_plat) {
visu_baltymu_kont_sumu_skirtumai <- data.frame()
termo_skirtumai <- data.frame() #desine tiesiniu lygciu sistemos puse matricose
#----
for (i in pdb_termo_lent$pdb) {
lizocimo_kontaktai <- data.table::fread(paste("../lizocimai/",i,".contacts.interresidue.table", sep = ""))
kontaktu_sumos <- fun_kontaktu_sumai(lizocimo_kontaktai, nul_lent_plat)
viena_eilute <- pdb_termo_lent %>%
filter(pdb == i)
if (viena_eilute$WT == "wt") {
wt_ir_lizocimas <- rbind(wt_platusis, kontaktu_sumos) %>%
transpose(keep.names = "kontakto_tipas") %>%
mutate(kont_sumu_skirtumas = V1 - V2) %>%
select(kontakto_tipas, kont_sumu_skirtumas) %>%
transpose(make.names = "kontakto_tipas")
} else {
wt_ir_lizocimas <- rbind(wtx_platusis, kontaktu_sumos) %>%
transpose(keep.names = "kontakto_tipas") %>%
mutate(kont_sumu_skirtumas = V1 - V2) %>%
select(kontakto_tipas, kont_sumu_skirtumas) %>%
transpose(make.names = "kontakto_tipas")
}
visu_baltymu_kont_sumu_skirtumai <- rbind(visu_baltymu_kont_sumu_skirtumai, wt_ir_lizocimas)
lizocimo_kontaktai = NULL
}
termo_skirtumai <- pdb_termo_lent %>%
select(-WT, -pdb)# %>%
#transpose(make.names = "pdb")
return(list(visu_baltymu_kont_sumu_skirtumai = as.matrix(visu_baltymu_kont_sumu_skirtumai),termo_skirtumai = as.matrix(termo_skirtumai)))
}
matricu_lenteles_229 <- fun_kont_sum_ir_temp_skirtumams(pdb_tm_229, wtx_platusis = wtx_1L63_platusis, wt_platusis = wt_2LZM_platusis, nuline_lentele_platusis)
library("tidyverse")
library("data.table")
library("compareDF")
library("tidyr")
#library("matlib")
library("pracma")
#library("Smisc")
library("readr")
lizocimai_pagr <- readr::read_rds("../data/pro_344_sm_suppinfo.rds")
nuline_lentele_platusis <- readr::read_rds("../data/nuline_lentele_platusis.rds")
wtx_1L63_platusis <- readr::read_rds("../data/wtx_1L63_platusis.rds")
wt_2LZM_platusis <- readr::read_rds("../data/wt_2LZM_platusis.rds")
pdb_tm_229 <- lizocimai_pagr %>%
select(pdb, deltaTm, WT) %>%
drop_na(pdb, deltaTm) %>%
filter(pdb != "2LZM" & pdb != "1L63") %>%
head(229)
pdb_tm_229
matricu_lenteles_229 <- fun_kont_sum_ir_temp_skirtumams(pdb_tm_229, wtx_platusis = wtx_1L63_platusis, wt_platusis = wt_2LZM_platusis, nuline_lentele_platusis)
A <- matricu_lenteles_229$visu_baltymu_kont_sumu_skirtumai %>% .[, -225] #.[-c(230:328), -225]
b <- c(matricu_lenteles_229$termo_skirtumai) # %>% .[-c(230:328)]
dim(A)
# rankifremoved <- sapply(1:ncol(A), function (x) qr(A[,-x])$rank)
# rankifremoved
# which(rankifremoved == max(rankifremoved))
# echelon <- echelon(A, b)
# echelon_df <- data.frame(echelon) %>% tail()
# echelon_df
tls_sprendimas_229 <- solve(A, b)
tls_sprendimas_229_df <- tls_sprendimas_229 %>% data.frame()
tls_sprendimas_229_df
# data.table::fwrite(
#   tls_sprendimas_wt_ir_wtx_df,
#   file = "./???",
#   sep = "\t",
#   dec = ".",
#   row.names  = FALSE,
#   col.names  = TRUE,
#   na = ""
# )
tls_sprendimas_229_df_pasalinus <- tls_sprendimas_229_df %>%
filter(. != min(tls_sprendimas_229_df))
tls_sprendimas_229_df %>%  summary()
tls_sprendimas_229_df_pasalinus %>% summary()
tls_sprendimas_229_df %>% as.data.table(keep.rownames = "pavadinimas") %>%
filter(. == min(.), .preserve = TRUE)
sort(tls_sprendimas_229) %>% data.frame()
ggplot(tls_sprendimas_229_df_pasalinus) +
aes(x = .) +
geom_histogram(bins = 30L, fill = "#0c4c8a") +
theme_minimal()
lizocimai_pagr <- readr::read_rds("./data/pro_344_sm_suppinfo.rds")
lizocimai_pagr <- readr::read_rds("../data/pro_344_sm_suppinfo.rds")
nuline_lentele_platusis <- readr::read_rds("../data/nuline_lentele_platusis.rds")
wtx_1L63_platusis <- readr::read_rds("../data/wtx_1L63_platusis.rds")
wt_2LZM_platusis <- readr::read_rds("../data/wt_2LZM_platusis.rds")
pdb_tm_visi_baltymai <- lizocimai_pagr %>%
select(pdb, deltaTm, WT) %>%
drop_na(pdb, deltaTm) %>%
filter(pdb != "2LZM" & pdb != "1L63")
pdb_tm_visi_baltymai
matricu_lenteles_visi_baltymai <- fun_kont_sum_ir_temp_skirtumams(pdb_tm_visi_baltymai, wtx_platusis = wtx_1L63_platusis, wt_platusis = wt_2LZM_platusis, nuline_lentele_platusis)
A <- matricu_lenteles_visi_baltymai$visu_baltymu_kont_sumu_skirtumai %>% .[, -225] #.[-c(230:328), -225]
b <- c(matricu_lenteles_visi_baltymai$termo_skirtumai) # %>% .[-c(230:328)]
dim(A)
A <- matricu_lenteles_visi_baltymai$visu_baltymu_kont_sumu_skirtumai %>% .[, -225] #.[-c(230:328), -225]
b <- c(matricu_lenteles_visi_baltymai$termo_skirtumai) # %>% .[-c(230:328)]
dim(A)
#tls_sprendimas_wt_ir_wtx <- solve(A, b)
tls_sprendimas_visi_baltymai <- pracma::qrSolve(A, b)
pavadinimai <- nuline_lentele_platusis %>%
transpose(keep.names = "kontakto_tipas") %>%
slice(-225) %>%
select(-V1)
tls_sprendimas_visi_baltymai_df <- cbind(pavadinimai, data.frame(tls_sprendimas_visi_baltymai))
tls_sprendimas_visi_baltymai_df
# data.table::fwrite(
#   tls_sprendimas_wt_ir_wtx_df,
#   file = "./rezultatai/koef_visi_lizocimai_qr_metodu_be_TRP.txt",
#   sep = "\t",
#   dec = ".",
#   row.names  = FALSE,
#   col.names  = TRUE,
#   na = ""
# )
tls_sprendimas_visi_baltymai_df %>%  summary()
arrange(tls_sprendimas_visi_baltymai_df, tls_sprendimas_visi_baltymai)
tls_sprendimas_visi_baltymai_df %>%
filter(str_detect(kontakto_tipas, "\\.")) %>%
arrange(tls_sprendimas_visi_baltymai)
#Temperaturos skirtumo reiksme teigiama - sumazejes antro baltymo lyginant su pirmuoju stabilumas, neigiama - padidejes stabilumas
#Jeigu antrajame baltyme padidideja atitinkamo kontakto plotu suma (padaugeja kontaktu), plotu skirtumas bus neigiamas, dauginant ji is neigiamo koeficiento, reiksme bus teigiama, todel temperaturu skirtumas dides, o stabilumas mazes. Su teigiamais koeficientais atvirksciai.
#Isvada, kad neigiami koeficientai stabiluma didina mazejant atitinkamo kontakto sumai (mazina stabiluma daugejant kontaktu) lyginant su pirmu baltymu, o tegiami koeficientai stabiluma didina didejant atitinkamo kontakto tipo sumai
ggplot(tls_sprendimas_visi_baltymai_df) +
aes(x = .) +
geom_histogram(bins = 30L, fill = "#0c4c8a") +
theme_minimal()
library("tidyverse")
library("data.table")
library("compareDF")
library("tidyr")
#library("matlib")
library("pracma")
#library("Smisc")
library("readr")
ggplot(tls_sprendimas_visi_baltymai_df) +
aes(x = .) +
geom_histogram(bins = 30L, fill = "#0c4c8a") +
theme_minimal()
apskaiciuotos_temperaturos <-
matricu_lenteles_visi_baltymai$visu_baltymu_kont_sumu_skirtumai[, -225] %*% tls_sprendimas_visi_baltymai
apskaiciuotos_temperaturos_df <- cbind(pdb_tm_visi_baltymai, data.frame(apskaiciuotos_temperaturos)) %>%
select(-WT)
ggplot(apskaiciuotos_temperaturos_df) +
aes(x = deltaTm, y = apskaiciuotos_temperaturos) +
geom_point(size = 1L, colour = "#0c4c8a") +
theme_minimal()
apskaiciuotos_temperaturos_df %>%
mutate(skirtumas = round((deltaTm- apskaiciuotos_temperaturos), digits = 3)) %>%
arrange(skirtumas)
ggplot(tls_sprendimas_visi_baltymai_df) +
aes(x = ".") +
geom_histogram(bins = 30L, fill = "#0c4c8a") +
theme_minimal()
ggplot(tls_sprendimas_visi_baltymai_df) +
aes(x = .) +
geom_histogram(bins = 30L, fill = "#0c4c8a") +
theme_minimal()
esquisse:::esquisser()
#tls_sprendimas_wt_ir_wtx <- solve(A, b)
tls_sprendimas_visi_baltymai <- pracma::qrSolve(A, b)
esquisse:::esquisser()
ggplot(tls_sprendimas_visi_baltymai_df) +
aes(x = tls_sprendimas_visi_baltymai) +
geom_histogram(bins = 30L, fill = "#0c4c8a") +
theme_minimal()
apskaiciuotos_temperaturos <-
matricu_lenteles_visi_baltymai$visu_baltymu_kont_sumu_skirtumai[, -225] %*% tls_sprendimas_visi_baltymai
apskaiciuotos_ir_teorines_temperaturos_df <- cbind(pdb_tm_visi_baltymai, data.frame(apskaiciuotos_temperaturos)) %>%
select(-WT)
ggplot(apskaiciuotos_ir_teorines_temperaturos_df) +
aes(x = deltaTm, y = apskaiciuotos_temperaturos) +
geom_point(size = 1L, colour = "#0c4c8a") +
theme_minimal()
apskaiciuotos_temperaturos_df %>%
mutate(skirtumas = round((deltaTm- apskaiciuotos_temperaturos), digits = 3)) %>%
arrange(skirtumas)
apskaiciuotos_temperaturos <-
matricu_lenteles_visi_baltymai$visu_baltymu_kont_sumu_skirtumai[, -225] %*% tls_sprendimas_visi_baltymai
apskaiciuotos_ir_teorines_temperaturos_df <- cbind(pdb_tm_visi_baltymai, data.frame(apskaiciuotos_temperaturos)) %>%
select(-WT)
ggplot(apskaiciuotos_ir_teorines_temperaturos_df) +
aes(x = deltaTm, y = apskaiciuotos_temperaturos) +
geom_point(size = 1L, colour = "#0c4c8a") +
theme_minimal()
apskaiciuotos_temperaturos_df %>%
mutate(skirtumas = round((deltaTm- apskaiciuotos_temperaturos), digits = 3)) %>%
arrange(skirtumas)
esquisse:::esquisser()
lizocimo_kontaktai <- data.table::fread("../lizocimai/1L63.contacts.interresidue.table")
nuline_lentele_platusis <- readr::read_rds("../data/nuline_lentele_platusis.rds")
paruosta_lentele <- fun_kontaktu_sumai(lizocimo_kontaktai, nuline_lentele_platusis)
paruosta_lentele
library(ggplot2)
# Dummy data
x <- LETTERS[1:20]
y <- paste0("var", seq(1,20))
data <- expand.grid(X=x, Y=y)
data$Z <- runif(400, 0, 5)
# Heatmap
ggplot(data, aes(X, Y, fill= Z)) +
geom_tile()
apskaiciuotos_temperaturos <-
matricu_lenteles_visi_baltymai$visu_baltymu_kont_sumu_skirtumai[, -225] %*% tls_sprendimas_visi_baltymai
apskaiciuotos_ir_teorines_temperaturos_df <- cbind(pdb_tm_visi_baltymai, data.frame(apskaiciuotos_temperaturos)) %>%
select(-WT)
ggplot(apskaiciuotos_ir_teorines_temperaturos_df) +
aes(x = deltaTm, y = apskaiciuotos_temperaturos) +
geom_point(size = 1L, colour = "#0c4c8a") +
theme_minimal()
apskaiciuotos_temperaturos_df %>%
mutate(skirtumas = round((deltaTm- apskaiciuotos_temperaturos), digits = 3)) %>%
arrange(skirtumas)
library("tidyverse")
library("data.table")
library("compareDF")
library("tidyr")
#library("matlib")
library("pracma")
#library("Smisc")
library("readr")
library(ggplot2)
# Dummy data
x <- LETTERS[1:20]
y <- paste0("var", seq(1,20))
data <- expand.grid(X=x, Y=y)
data$Z <- runif(400, 0, 5)
# Heatmap
ggplot(data, aes(X, Y, fill= Z)) +
geom_tile()
library(ggplot2)
# Dummy data
x <- LETTERS[1:20]
y <- paste0("var", seq(1,20))
data <- expand.grid
data
data$Z <- runif(400, 0, 5)
library(ggplot2)
# Dummy data
x <- LETTERS[1:20]
y <- paste0("var", seq(1,20))
data <- expand.grid
data$Z <- runif(400, 0, 5)
tls_sprendimas_visi_baltymai_df
library("tidyverse")
library("data.table")
library("compareDF")
library("tidyr")
#library("matlib")
library("pracma")
#library("Smisc")
library("readr")
tls_sprendimas_visi_baltymai_df
tls_sprendimas_visi_baltymai_df
library(ggplot2)
# Dummy data
x <- LETTERS[1:20]
y <- paste0("var", seq(1,20))
data <- expand.grid
data$Z <- runif(400, 0, 5)
library(ggplot2)
# Dummy data
x <- LETTERS[1:20]
y <- paste0("var", seq(1,20))
data <- expand.grid(X=x, Y=y)
data$Z <- runif(400, 0, 5)
# Heatmap
ggplot(data, aes(X, Y, fill= Z)) +
geom_tile()
library(ggplot2)
# Dummy data
x <- LETTERS[1:20]
y <- paste0("var", seq(1,20))
data <- expand.grid(X=x, Y=y)
data
data$Z <- runif(400, 0, 5)
# Heatmap
ggplot(data, aes(X, Y, fill= Z)) +
geom_tile()
lizocimo_kontaktai <- data.table::fread("../lizocimai/1L63.contacts.interresidue.table")
library("tidyverse")
library("data.table")
library("compareDF")
library("tidyr")
#library("matlib")
library("pracma")
#library("Smisc")
library("readr")
lizocimo_kontaktai <- data.table::fread("../lizocimai/1L63.contacts.interresidue.table")
lizocimo_kontaktai <- data.table::fread("./lizocimai/1L63.contacts.interresidue.table")
nuline_lentele_platusis <- readr::read_rds("./data/nuline_lentele_platusis.rds")
paruosta_lentele <- fun_kontaktu_sumai(lizocimo_kontaktai, nuline_lentele_platusis)
fun_kontaktu_sumai <- function(liz_kont, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- liz_kont %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont_matrica <- as.matrix(data.frame(ar_1 = liz_kont$V6, ar_2 = liz_kont$V13))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "_")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".") %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
kont_sumos_plat <- spread(kont_sumos, kontakto_tipas, kontakto_suma)
sujungta <- full_join(nul_lentele_plat, kont_sumos_plat) %>%
gather() %>%
group_by(key) %>%
summarise(kontakto_suma = sum(value)) %>%
mutate_all(~replace(., is.na(.), 0)) %>%
spread(., key, kontakto_suma)
return(sujungta)
}
paruosta_lentele <- fun_kontaktu_sumai(lizocimo_kontaktai, nuline_lentele_platusis)
paruosta_lentele
paruosta_lentele <- fun_kontaktu_sumai(lizocimo_kontaktai, nuline_lentele_platusis) %>%
transpose(keep.names = "pavadinimai")
paruosta_lentele
paruosta_lentele <- fun_kontaktu_sumai(lizocimo_kontaktai, nuline_lentele_platusis) %>%
transpose(keep.names = "pavadinimai") %>%
rename(V1 = "kontakto_plotas")
paruosta_lentele <- fun_kontaktu_sumai(lizocimo_kontaktai, nuline_lentele_platusis) %>%
transpose(keep.names = "pavadinimai") %>%
rename("kontakto_plotas" = "V1")
paruosta_lentele
library(ggplot2)
# Dummy data
data <- paruosta_lentele <- expand.grid(X=pavadinimai, Y=pavadinimai)
library(ggplot2)
# Dummy data
data <- paruosta_lentele %>%
expand.grid(X=pavadinimai, Y=pavadinimai)
library(ggplot2)
# Dummy data
data <- paruosta_lentele %>%
expand.grid(X=paruosta_lentele$pavadinimai, Y=paruosta_lentele$pavadinimai)
data
data$Z <- runif(400, 0, 5)
library(ggplot2)
# Dummy data
data <- paruosta_lentele %>%
expand.grid(X=paruosta_lentele$pavadinimai, Y=paruosta_lentele$pavadinimai)
data
data$Z <- runif(105800, 0, 5)
# Heatmap
ggplot(data, aes(X, Y, fill= Z)) +
geom_tile()
