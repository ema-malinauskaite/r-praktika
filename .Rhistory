liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar1_atom1 = recode_factor(ar1_atom1, "." = "solvent", fixed =TRUE)
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar1_atom1 = recode_factor(ar1_atom1, "." = "solvent", fixed =TRUE))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
lizocimo_kontaktai_1L63 <- data.table::fread("./lizocimai/1L63.contacts.interatom.table")
# <- readr::read_rds("./data/nuline_lentele_platusis.rds")
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar1_atom1 = recode_factor(ar1_atom1, "\\.-\\." = "solvent", ))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode_factor(ar1_atom1, "\\.-\\." = "solvent", ))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
lizocimo_kontaktai_1L63 <- data.table::fread("./lizocimai/1L63.contacts.interatom.table")
# <- readr::read_rds("./data/nuline_lentele_platusis.rds")
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, "\\.-\\." = "solvent", ))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, "[.-.]" = "solvent", ))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, "\\.\\-\\." = "solvent", ))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode(ar2_atom2, "." = "solvent", ))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode(ar2_atom2, "\\.-\\." = "solvent", ))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode(ar2_atom2, "\\.\\-\\." = "solvent", ))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, "\\.\\-\\." = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, cat(".-.") = "solvent"))
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, (cat(".-.")) = "solvent"))
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, "[[:punct:]]" = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, "[[:punct:]][[:punct:]][[:punct:]]" = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = as.factor(ar2_atom2)) %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, "[[:punct:]][[:punct:]][[:punct:]]" = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = as.factor(ar2_atom2)) %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, "." = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = as.factor(ar2_atom2)) %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, ".-." = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = as.factor(ar2_atom2)) %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2, paste(".-.") = "solvent"))
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
liz_kont <- liz_kont %>%
mutate(ar2_atom2 = as.factor(ar2_atom2)) %>%
mutate(ar2_atom2 = recode_factor(ar2_atom2,".-." = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
# liz_kont <- liz_kont %>%
#   mutate(ar2_atom2 = recode_factor(ar2_atom2,".-." = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- head(liz_kont) %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
# liz_kont <- liz_kont %>%
#   mutate(ar2_atom2 = recode_factor(ar2_atom2,".-." = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
head(paruosta_lentele_1L63)
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- liz_kont %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,"_",V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,"_", V14))
# liz_kont <- liz_kont %>%
#   mutate(ar2_atom2 = recode_factor(ar2_atom2,".-." = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
lizocimo_kontaktai_1L63 <- data.table::fread("./lizocimai/1L63.contacts.interatom.table")
# <- readr::read_rds("./data/nuline_lentele_platusis.rds")
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
suskaiciuoti_atomu_tipai_visiems_baltymams2 <- NULL
for (i in pdb_sarasas$pdb) {
lizocimo_kontaktai <- data.table::fread(paste("./lizocimai/",i,".contacts.interatom.table", sep = ""))
atomu_tipu_skaicius <- lizocimo_kontaktai %>%
select(V14, V15) %>%
group_by(V14) %>%
summarise(suma = sum(V15)) %>%
count()
suskaiciuoti_atomu_tipai_visiems_baltymams2 <- rbind(suskaiciuoti_atomu_tipai_visiems_baltymams2, atomu_tipu_skaicius)
lizocimo_kontaktai = NULL
}
suskaiciuoti_kontaktu_tipai_visiems_baltymams <- NULL
for (i in pdb_sarasas$pdb) {
lizocimo_kontaktai <- data.table::fread(paste("./lizocimai/",i,".contacts.interatom.table", sep = ""))
kontaktu_tipu_skaicius <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai)
suskaiciuoti_kontaktu_tipai_visiems_baltymams <- rbind(suskaiciuoti_kontaktu_tipai_visiems_baltymams, nrow(kontaktu_tipu_skaicius))
lizocimo_kontaktai = NULL
}
suskaiciuoti_kontaktu_tipai_visiems_baltymams <- NULL
for (i in pdb_sarasas$pdb) {
lizocimo_kontaktai <- data.table::fread(paste("./lizocimai/",i,".contacts.interatom.table", sep = ""))
kontaktu_tipu_skaicius <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai)
suskaiciuoti_kontaktu_tipai_visiems_baltymams <- rbind(suskaiciuoti_kontaktu_tipai_visiems_baltymams, nrow(kontaktu_tipu_skaicius))
lizocimo_kontaktai = NULL
}
suskaiciuoti_kontaktu_tipai_visiems_baltymams
summary(suskaiciuoti_kontaktu_tipai_visiems_baltymams)
fun_atom_kontaktu_grupavimui <- function(liz_kont) {#, nul_lentele_plat) { #pirmas - kontaktu lentele, antras - nuline lentele
liz_kont <- liz_kont %>%
select(V6, V7, V13, V14, V15) %>%
mutate(V6 = recode_factor(V6,"MSE" = "MET")) %>%
mutate(V13 = recode_factor(V13,"MSE" = "MET"))
liz_kont$ar1_atom1 <- with(liz_kont, paste0(V6,V7))
liz_kont$ar2_atom2 <- with(liz_kont, paste0(V13,V14))
# liz_kont <- liz_kont %>%
#   mutate(ar2_atom2 = recode_factor(ar2_atom2,".-." = "solvent"))
liz_kont_matrica <- as.matrix(data.frame(ar1_atom1 = liz_kont$ar1_atom1, ar2_atom2 = liz_kont$ar2_atom2))
surusiuoti_pavad <- liz_kont_matrica %>%
split(., row(.)) %>% sapply(
. %>% sort %>% paste(collapse = "-")
) %>% data.frame
kont_sumos <- cbind(liz_kont, surusiuoti_pavad) %>%
rename(kontakto_tipas = ".")
kont_sumos <- kont_sumos %>%
group_by(kontakto_tipas) %>%
summarise(kontakto_suma = sum(V15))
}
lizocimo_kontaktai_1L63 <- data.table::fread("./lizocimai/1L63.contacts.interatom.table")
# <- readr::read_rds("./data/nuline_lentele_platusis.rds")
paruosta_lentele_1L63 <- fun_atom_kontaktu_grupavimui(lizocimo_kontaktai_1L63)
paruosta_lentele_1L63
